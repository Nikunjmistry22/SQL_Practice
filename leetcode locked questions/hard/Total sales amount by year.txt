select p.product_id,product_name,year(period_start)as report_year,
datediff(period_end,period_start)*average_daily_sales as total_amount 
from product p join Sales s on p.product_id=s.product_id
union 
select p.product_id,product_name,year(period_end),
datediff(period_end,period_start)*average_daily_sales as total_amount 
from product p join Sales s on p.product_id=s.product_id
