with cte as (select product_id,sum(new_price) as total from 
Products where change_date <= '2019-08-16' group by product_id)
practice-# select distinct p.product_id,coalesce(NULL,total,10) 
as price from Products 
p left join cte c on p.product_id=c.product_id;